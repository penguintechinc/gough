# Gough Hypervisor Automation System - Environment Configuration
# Copy this file to .env and customize for your environment
# Designed for scalability up to 100+ servers

# ============================================================================
# DEPLOYMENT ENVIRONMENT
# ============================================================================
COMPOSE_PROJECT_NAME=gough
ENVIRONMENT=development  # development, staging, production
PROJECT_VERSION=1.0.0
TIMEZONE=UTC
LOCALE=en_US.UTF-8

# ============================================================================
# NETWORK CONFIGURATION
# ============================================================================

# Management Network (Container communication)
MANAGEMENT_SUBNET=172.20.0.0/16
MANAGEMENT_GATEWAY=172.20.0.1

# Provisioning Network (PXE boot and DHCP for bare metal servers)
PROVISIONING_SUBNET=192.168.100.0/24
PROVISIONING_GATEWAY=192.168.100.1

# External Network Interface (for bare metal servers)
PXE_INTERFACE=eth0

# DNS Configuration
PRIMARY_DNS=8.8.8.8
SECONDARY_DNS=8.8.4.4

# ============================================================================
# PORT CONFIGURATION
# ============================================================================

# MaaS Ports
MAAS_WEB_PORT=5240
MAAS_API_PORT=5241
MAAS_RACK_PORT=5242
MAAS_META_PORT=5247

# Network Service Ports
DNS_PORT=53
DHCP_PORT=67
TFTP_PORT=69
HTTP_PORT=8080
HTTPS_PORT=8443

# Application Ports
MANAGEMENT_SERVER_PORT=8000
FLEET_HTTP_PORT=8080
FLEET_HTTPS_PORT=8443
POSTGRES_PORT=5432
MYSQL_PORT=3306
REDIS_PORT=6379

# Nginx Proxy Ports (production)
NGINX_HTTP_PORT=80
NGINX_HTTPS_PORT=443

# =============================================================================
# MAAS CONFIGURATION
# =============================================================================

# MaaS server settings
MAAS_URL=http://172.20.0.10:5240/MAAS/
MAAS_API_KEY=consumer_key:token_key:token_secret
MAAS_ADMIN_USERNAME=admin
MAAS_ADMIN_PASSWORD=admin
MAAS_ADMIN_EMAIL=admin@maas.local

# DHCP Configuration
ENABLE_DHCP=true
DHCP_SUBNET=192.168.1.0/24
DHCP_RANGE_START=192.168.1.100
DHCP_RANGE_END=192.168.1.200
DHCP_GATEWAY=192.168.1.1
DHCP_DNS_SERVERS=8.8.8.8,8.8.4.4

# PXE Boot Configuration
PXE_INTERFACE=eth0
TFTP_ROOT=/var/lib/maas/tftp

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# PostgreSQL for Management Server
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_DB=management
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
DATABASE_URL=postgresql://postgres:postgres@postgres:5432/management

# MySQL for FleetDM
MYSQL_HOST=mysql
MYSQL_PORT=3306
MYSQL_ROOT_PASSWORD=rootpass
MYSQL_DATABASE=fleet
MYSQL_USER=fleet
MYSQL_PASSWORD=fleetpass

# Redis for Caching
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DATABASE=0
REDIS_URL=redis://redis:6379/0

# =============================================================================
# MANAGEMENT SERVER CONFIGURATION
# =============================================================================

# py4web settings
PY4WEB_HOST=0.0.0.0
PY4WEB_PORT=8000
PY4WEB_APPS_FOLDER=/opt/py4web-apps
SECRET_KEY=change-this-secret-key-in-production-environment
DEBUG=false

# API Configuration
API_VERSION=v1
API_RATE_LIMIT=1000

# Session Configuration
SESSION_TIMEOUT=3600
JWT_SECRET_KEY=change-this-jwt-key-in-production

# =============================================================================
# FLEETDM CONFIGURATION
# =============================================================================

# Fleet server settings
FLEET_URL=https://172.20.0.3:8443
FLEET_HOST=0.0.0.0
FLEET_PORT=8080
FLEET_TLS_PORT=8443

# Fleet authentication
FLEET_ADMIN_EMAIL=admin@fleet.local
FLEET_ADMIN_PASSWORD=admin123
FLEET_API_TOKEN=change-this-api-token

# Fleet database settings
FLEET_MYSQL_ADDRESS=mysql:3306
FLEET_MYSQL_DATABASE=fleet
FLEET_MYSQL_USERNAME=fleet
FLEET_MYSQL_PASSWORD=fleetpass
FLEET_REDIS_ADDRESS=redis:6379

# OSQuery settings
OSQUERY_VERSION=5.10.2
OSQUERY_ENROLL_SECRET=change-this-enroll-secret
OSQUERY_NODE_KEY_SIZE=24
OSQUERY_HOST_IDENTIFIER=uuid

# =============================================================================
# AGENT CONFIGURATION
# =============================================================================

# Agent settings
AGENT_VERSION=1.0.0
AGENT_PORT=9090
AGENT_API_KEY=change-this-agent-api-key
AGENT_HEARTBEAT_INTERVAL=60
AGENT_METRICS_INTERVAL=300

# Agent features
ENABLE_DOCKER_MONITORING=true
ENABLE_LXD_MONITORING=true
ENABLE_OSQUERY=true
ENABLE_SYSTEM_MONITORING=true

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

# SSL/TLS Configuration
ENABLE_SSL=true
SSL_CERT_PATH=/etc/ssl/certs
SSL_KEY_PATH=/etc/ssl/private

# SSH Configuration
SSH_KEY_TYPE=ed25519
SSH_PUBLIC_KEY=ssh-ed25519_AAAAC3NzaC1lZDI1NTE5AAAAI... # Replace with your public key
ANSIBLE_SSH_PUBLIC_KEY=ssh-ed25519_AAAAC3NzaC1lZDI1NTE5AAAAI... # Replace with ansible public key

# Firewall Configuration
ENABLE_UFW=true
ENABLE_FAIL2BAN=true

# Password Security
MAAS_USER_PASSWORD_HASH=$6$rounds=4096$salt$hash  # Replace with actual hash
BCRYPT_ROUNDS=12

# =============================================================================
# CLOUD-INIT CONFIGURATION
# =============================================================================

# Default cloud-init settings
DEFAULT_DISTRO_SERIES=jammy
DEFAULT_ARCHITECTURE=amd64
DEFAULT_KERNEL=generic

# Package installation
INSTALL_DOCKER=true
INSTALL_LXD=true
INSTALL_MONITORING_TOOLS=true

# =============================================================================
# ANSIBLE CONFIGURATION
# =============================================================================

# Ansible settings
ANSIBLE_HOST_KEY_CHECKING=False
ANSIBLE_TIMEOUT=30
ANSIBLE_FORKS=10
ANSIBLE_CONFIG=/ansible/ansible.cfg

# Inventory settings
DYNAMIC_INVENTORY=true
INVENTORY_UPDATE_INTERVAL=300

# =============================================================================
# MONITORING AND LOGGING
# =============================================================================

# Logging configuration
LOG_LEVEL=INFO
LOG_FORMAT=json
MAX_LOG_SIZE=100MB
LOG_RETENTION_DAYS=30

# Monitoring endpoints
ENABLE_METRICS=true
METRICS_PORT=9323
HEALTHCHECK_INTERVAL=30

# External monitoring (optional)
PROMETHEUS_URL=
GRAFANA_URL=
ELASTIC_URL=

# =============================================================================
# BACKUP CONFIGURATION
# =============================================================================

# Backup settings
ENABLE_BACKUPS=true
BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM
BACKUP_RETENTION_DAYS=7
BACKUP_LOCATION=/backups

# S3 Backup (optional)
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
S3_BUCKET=
S3_REGION=us-east-1

# =============================================================================
# PERFORMANCE TUNING
# =============================================================================

# Container resource limits
MAAS_MEMORY_LIMIT=2G
MANAGEMENT_MEMORY_LIMIT=1G
FLEET_MEMORY_LIMIT=1G
AGENT_MEMORY_LIMIT=512M

# Database connection pools
POSTGRES_MAX_CONNECTIONS=100
MYSQL_MAX_CONNECTIONS=100
REDIS_MAX_CONNECTIONS=10

# =============================================================================
# DEVELOPMENT SETTINGS
# =============================================================================

# Development flags (set to false in production)
ENABLE_DEBUG=false
ENABLE_TESTING_ENDPOINTS=false
SKIP_SSL_VERIFICATION=false

# Testing configuration
TEST_DATABASE_URL=postgresql://postgres:postgres@postgres:5432/test_management
TEST_REDIS_URL=redis://redis:6379/1

# =============================================================================
# CUSTOM CONFIGURATION
# =============================================================================

# Add your custom environment variables below
# CUSTOM_VARIABLE=value