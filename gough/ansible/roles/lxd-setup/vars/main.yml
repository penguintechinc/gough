---
# LXD Setup Role - Variables

# Package configuration
lxd_prerequisite_packages:
  - snapd
  - bridge-utils
  - dnsmasq-base

lxd_packages:
  - lxd
  - lxc

lxd_zfs_packages:
  - zfsutils-linux
  - zfs-dkms

# User configuration
lxd_users:
  - ubuntu
  - gough

# Storage configuration
lxd_storage_backend: "zfs"  # zfs, btrfs, dir, lvm
lxd_storage_pool_name: "default"
lxd_storage_size: "50GB"

# Network configuration
lxd_bridge_name: "lxdbr0"
lxd_bridge_ipv4_address: "10.0.0.1/24"
lxd_bridge_ipv4_dhcp: true
lxd_bridge_ipv4_dhcp_first: "10.0.0.2"
lxd_bridge_ipv4_dhcp_last: "10.0.0.254"
lxd_bridge_ipv6_address: "fd00:56ad:9f7a:9800::1/64"
lxd_bridge_ipv6_nat: true

# API configuration
lxd_https_port: 8443
lxd_trust_password: ""  # Set this in vault or group_vars

# Additional storage pools
lxd_storage_pools: []
# Example:
# lxd_storage_pools:
#   - name: "fast-storage"
#     driver: "zfs"
#     config: "source=/dev/nvme0n1"
#   - name: "bulk-storage" 
#     driver: "dir"
#     config: "source=/var/lib/lxd/storage-pools/bulk"

# Additional networks
lxd_networks: []
# Example:
# lxd_networks:
#   - name: "production-net"
#     config:
#       ipv4.address: "192.168.100.1/24"
#       ipv4.dhcp: "true"
#       ipv4.nat: "true"
#   - name: "isolated-net"
#     config:
#       ipv4.address: "172.16.0.1/24"
#       ipv4.dhcp: "false"

# Custom profiles
lxd_profiles: []
# Example:
# lxd_profiles:
#   - name: "docker-host"
#     config:
#       config:
#         security.nesting: "true"
#         security.privileged: "true"
#       devices:
#         eth0:
#           name: "eth0"
#           network: "lxdbr0"
#           type: "nic"
#         root:
#           path: "/"
#           pool: "default"
#           type: "disk"
#           size: "20GB"

# Image servers and base images
lxd_image_servers:
  - name: "ubuntu"
    url: "https://cloud-images.ubuntu.com/releases"
  - name: "ubuntu-daily"
    url: "https://cloud-images.ubuntu.com/daily"

lxd_base_images:
  - source: "ubuntu:22.04"
    alias: "ubuntu-22.04"
  - source: "ubuntu:20.04"
    alias: "ubuntu-20.04"
  - source: "ubuntu:24.04"
    alias: "ubuntu-24.04"

# API configuration
lxd_api_config:
  - key: "core.https_address"
    value: ":8443"
  - key: "images.auto_update_interval"
    value: "6"
  - key: "images.remote_cache_expiry"
    value: "10"

# Firewall configuration
lxd_firewall_ports:
  - "8443"  # LXD HTTPS API

# Feature flags
lxd_clustering_enabled: false
lxd_monitoring_enabled: true
lxd_configure_firewall: true
lxd_auto_cleanup: true
lxd_run_tests: true

# Test configuration
lxd_test_image: "ubuntu:22.04"

# Environment-specific settings
lxd_environment_config:
  development:
    storage_size: "20GB"
    auto_cleanup: true
    monitoring: true
  staging:
    storage_size: "50GB"
    auto_cleanup: true
    monitoring: true
  production:
    storage_size: "100GB"
    auto_cleanup: false
    monitoring: true
    clustering: true